<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Growth | Alaskan sablefish research</title>
  <meta name="description" content="This Gitbook documents my post-doctoral research relating to Alaskan sablefish." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Growth | Alaskan sablefish research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This Gitbook documents my post-doctoral research relating to Alaskan sablefish." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Growth | Alaskan sablefish research" />
  
  <meta name="twitter:description" content="This Gitbook documents my post-doctoral research relating to Alaskan sablefish." />
  

<meta name="author" content="C.Marsh" />


<meta name="date" content="2022-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tagdata.html"/>
<link rel="next" href="refpoints.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sablefish Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#gitbook-outline"><i class="fa fa-check"></i>Gitbook outline</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#future-things-to-consider"><i class="fa fa-check"></i>Future things to consider</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objectives.html"><a href="objectives.html"><i class="fa fa-check"></i><b>2</b> A list of objectives/milestones that we have set along the project life</a></li>
<li class="chapter" data-level="3" data-path="modeldescription.html"><a href="modeldescription.html"><i class="fa fa-check"></i><b>3</b> Current Alaskan sablefish stock assessment model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeldescription.html"><a href="modeldescription.html#modelequations"><i class="fa fa-check"></i><b>3.1</b> Process equations</a>
<ul>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#initialisation-gleft.right"><i class="fa fa-check"></i>Initialisation (<span class="math inline">\(g\left(.\right)\)</span>)</a></li>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#population-dynamics-fleft.right"><i class="fa fa-check"></i>Population dynamics (<span class="math inline">\(f\left(.\right)\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="modeldescription.html"><a href="modeldescription.html#observationsection"><i class="fa fa-check"></i><b>3.2</b> Observation equations</a>
<ul>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#catch-at-age"><i class="fa fa-check"></i>Catch at age</a></li>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#relative-abundance-indices"><i class="fa fa-check"></i>Relative abundance indices</a></li>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#catch-at-length"><i class="fa fa-check"></i>Catch at length</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeldescription.html"><a href="modeldescription.html#symbols"><i class="fa fa-check"></i><b>3.3</b> Symbol Notation</a>
<ul>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#inference"><i class="fa fa-check"></i>Inference</a></li>
<li class="chapter" data-level="" data-path="modeldescription.html"><a href="modeldescription.html#todo"><i class="fa fa-check"></i>TODO</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html"><i class="fa fa-check"></i><b>4</b> Spatial stock assessment model for Alaskan sablefish</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html#spatialmodelequations"><i class="fa fa-check"></i><b>4.1</b> Process equations</a>
<ul>
<li class="chapter" data-level="" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html#initialisation-gleft.right-1"><i class="fa fa-check"></i>Initialisation (<span class="math inline">\(g\left(.\right)\)</span>)</a></li>
<li class="chapter" data-level="" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html#population-dynamics-fleft.right-1"><i class="fa fa-check"></i>Population dynamics (<span class="math inline">\(f\left(.\right)\)</span>)</a></li>
<li class="chapter" data-level="" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html#to-do"><i class="fa fa-check"></i>To DO</a></li>
<li class="chapter" data-level="" data-path="spatialmodeldescription.html"><a href="spatialmodeldescription.html#appendix"><i class="fa fa-check"></i>Appendix</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="surveydata.html"><a href="surveydata.html"><i class="fa fa-check"></i><b>5</b> Survey data</a>
<ul>
<li class="chapter" data-level="" data-path="surveydata.html"><a href="surveydata.html#abundance-data"><i class="fa fa-check"></i>Abundance data</a></li>
<li class="chapter" data-level="" data-path="surveydata.html"><a href="surveydata.html#age-data"><i class="fa fa-check"></i>Age data</a></li>
<li class="chapter" data-level="" data-path="surveydata.html"><a href="surveydata.html#length-data"><i class="fa fa-check"></i>Length data</a></li>
<li class="chapter" data-level="" data-path="surveydata.html"><a href="surveydata.html#age-length-data"><i class="fa fa-check"></i>Age-length data</a></li>
<li class="chapter" data-level="" data-path="surveydata.html"><a href="surveydata.html#appendix-1"><i class="fa fa-check"></i>Appendix</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="observerdata.html"><a href="observerdata.html"><i class="fa fa-check"></i><b>6</b> Observer data</a>
<ul>
<li class="chapter" data-level="" data-path="observerdata.html"><a href="observerdata.html#catch-data"><i class="fa fa-check"></i>Catch data</a></li>
<li class="chapter" data-level="" data-path="observerdata.html"><a href="observerdata.html#length-data-1"><i class="fa fa-check"></i>Length data</a>
<ul>
<li class="chapter" data-level="" data-path="observerdata.html"><a href="observerdata.html#regression-tree-analysis"><i class="fa fa-check"></i>regression tree analysis</a></li>
<li class="chapter" data-level="" data-path="observerdata.html"><a href="observerdata.html#catch-at-length-estimator"><i class="fa fa-check"></i>Catch at length estimator</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="observerdata.html"><a href="observerdata.html#age-data-1"><i class="fa fa-check"></i>Age data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tagdata.html"><a href="tagdata.html"><i class="fa fa-check"></i><b>7</b> Tagging data exploration</a>
<ul>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#exploratory-analysis-of-the-tag-data"><i class="fa fa-check"></i>Exploratory analysis of the tag data</a></li>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#integrating-tagging-observations-in-spatial-age-structured-models"><i class="fa fa-check"></i>Integrating tagging observations in spatial age-structured models</a></li>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#tagging-things-to-consider-with-relevant-references"><i class="fa fa-check"></i>Tagging things to consider with relevant references</a></li>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#releasing-tags"><i class="fa fa-check"></i>Releasing tags</a>
<ul>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#things-to-consider-for-tag-release"><i class="fa fa-check"></i>Things to consider for tag release</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tagdata.html"><a href="tagdata.html#tag-recovery-observations"><i class="fa fa-check"></i>Tag recovery observations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="growth.html"><a href="growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="" data-path="growth.html"><a href="growth.html#growth-estimation-using-the-laslettevesonpolacheck-lep-method"><i class="fa fa-check"></i>Growth estimation using the Laslett–Eveson–Polacheck (LEP) method</a>
<ul>
<li class="chapter" data-level="" data-path="growth.html"><a href="growth.html#age-at-length-growth-model"><i class="fa fa-check"></i>Age-at-length growth model</a></li>
<li class="chapter" data-level="" data-path="growth.html"><a href="growth.html#tag-recapture-growth-data"><i class="fa fa-check"></i>Tag recapture growth data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="growth.html"><a href="growth.html#simulation-test-the-lep-method"><i class="fa fa-check"></i>Simulation test the “LEP” method</a></li>
<li class="chapter" data-level="" data-path="growth.html"><a href="growth.html#next-steps"><i class="fa fa-check"></i>Next steps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="refpoints.html"><a href="refpoints.html"><i class="fa fa-check"></i><b>9</b> Review/summarise reference points</a></li>
<li class="chapter" data-level="10" data-path="sexratios.html"><a href="sexratios.html"><i class="fa fa-check"></i><b>10</b> Sex ratios in age and length composition data</a>
<ul>
<li class="chapter" data-level="" data-path="sexratios.html"><a href="sexratios.html#a-simple-simulation"><i class="fa fa-check"></i>A simple simulation</a>
<ul>
<li class="chapter" data-level="" data-path="sexratios.html"><a href="sexratios.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="sexratios.html"><a href="sexratios.html#future-research-that-was-not-considered-in-this-simple-simulation"><i class="fa fa-check"></i>Future research that was not considered in this simple simulation</a></li>
<li class="chapter" data-level="" data-path="sexratios.html"><a href="sexratios.html#scenario-1"><i class="fa fa-check"></i>Scenario 1</a></li>
<li class="chapter" data-level="" data-path="sexratios.html"><a href="sexratios.html#scenario-2"><i class="fa fa-check"></i>Scenario 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Fexplore.html"><a href="Fexplore.html"><i class="fa fa-check"></i><b>11</b> Fishing mortality approaches</a>
<ul>
<li class="chapter" data-level="" data-path="Fexplore.html"><a href="Fexplore.html#set-up-a-simulation"><i class="fa fa-check"></i>Set up a simulation</a></li>
<li class="chapter" data-level="" data-path="Fexplore.html"><a href="Fexplore.html#appendix---hybrid-approach"><i class="fa fa-check"></i>Appendix - Hybrid approach</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatialInit.html"><a href="spatialInit.html"><i class="fa fa-check"></i><b>12</b> Initialising the plus group in spatial models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.fisheries.noaa.gov/alaska/science-data/alaska-sablefish-fisheries-and-assessment" target="blank">NOAA Website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Alaskan sablefish research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="growth" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Growth<a href="growth.html#growth" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Growth is an important input in stock assessments. Although we are not considering spatial varying growth in the spatial stock assessments due to computational reasons. We still want to look at the data to see if growth is significantly different between the spatial regions under consideration.</p>
<div id="growth-estimation-using-the-laslettevesonpolacheck-lep-method" class="section level2 unnumbered hasAnchor">
<h2>Growth estimation using the Laslett–Eveson–Polacheck (LEP) method<a href="growth.html#growth-estimation-using-the-laslettevesonpolacheck-lep-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another use of tag-recovery data is for estimating growth models which are important inputs for stock assessment models. The section explores the “Laslett–Eveson–Polacheck (LEP)” approach, based on <span class="citation">Laslett, Eveson, and Polacheck (<a href="#ref-laslett2002flexible" role="doc-biblioref">2002</a>)</span> &amp; <span class="citation">Eveson, Laslett, and Polacheck (<a href="#ref-eveson2004integrated" role="doc-biblioref">2004</a>)</span> and described in <span class="citation">Aires-da-Silva et al. (<a href="#ref-aires2015improved" role="doc-biblioref">2015</a>)</span>.</p>
<p>The idea is to use a single growth model that fits to two observational data sets (ideally within the assessment, but for now this analysis is independent of the assessment). The two data sets are are age and length observations and tag-increment observations from tagging experiments. A benefit of this method, other than estimating growth is that estimates of ages of fish at release are a derivative that can then be used as inputs for tag releases in an age-structured stock assessment model (what to do with observations with no sex information?).</p>
<div id="age-at-length-growth-model" class="section level3 unnumbered hasAnchor">
<h3>Age-at-length growth model<a href="growth.html#age-at-length-growth-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Richards growth curve was assumed as was done in <span class="citation">Aires-da-Silva et al. (<a href="#ref-aires2015improved" role="doc-biblioref">2015</a>)</span> (but this could be extended). The Richards growth formulation follows</p>
<p><span class="math display" id="eq:richardsgrowth">\[\begin{equation}
  \bar{l}_{a} = L_{\infty} \left( 1 + \frac{1}{p} \exp \{-K(a - a_0)\}\right)^{-p}
  \tag{8.1}
\end{equation}\]</span>
where, <span class="math inline">\(\bar{l}_{a}\)</span> is the mean length at age <span class="math inline">\(a\)</span>, <span class="math inline">\(L_{\infty}\)</span> is the asymptotic length, <span class="math inline">\(K\)</span> is the growth coefficient and <span class="math inline">\(p\)</span> is a shape parameter that is related to the ratio <span class="math inline">\(\bar{l}_{a} / L_{\infty}\)</span> at the inflexion point.</p>
</div>
<div id="tag-recapture-growth-data" class="section level3 unnumbered hasAnchor">
<h3>Tag recapture growth data<a href="growth.html#tag-recapture-growth-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(l_{1,i}\)</span></td>
<td>length of individual <span class="math inline">\(i\)</span> at release</td>
</tr>
<tr class="even">
<td><span class="math inline">\(l_{2,i}\)</span></td>
<td>length of individual <span class="math inline">\(i\)</span> at recapture</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_{1,i}\)</span></td>
<td>age of individual <span class="math inline">\(i\)</span> at release. Denoted as <span class="math inline">\(A\)</span> in <span class="citation">Aires-da-Silva et al. (<a href="#ref-aires2015improved" role="doc-biblioref">2015</a>)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_{2,i}\)</span></td>
<td>age of individual <span class="math inline">\(i\)</span> at recapture</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\Delta_t\)</span></td>
<td>Time at liberty <span class="math inline">\(\Delta_t = a_{2,i} - a_{1,i}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Just one comment on notation!!!</strong> in most all the papers that use this method, they ignore the individual notation of <span class="math inline">\(A\)</span>. That is not an issue in general however it confuses me when they describe the prior on this.</p>
<p>The sub-models for the release and recapture lengths follow,
<span class="math display" id="eq:lengthatrelease">\[\begin{equation}
  l_{1,i} = L_{\infty} \left( 1 + \frac{1}{p} \exp \{-K(a_{1,i} - a_0)\}\right)^{-p}
  \tag{8.2}
\end{equation}\]</span></p>
<p>and,
<span class="math display" id="eq:lengthatrecapture">\[\begin{equation}
  l_{2,i} = L_{\infty} \left( 1 + \frac{1}{p} \exp \{-K(a_{1,i} + \Delta_t - a_0)\}\right)^{-p}
  \tag{8.3}
\end{equation}\]</span></p>
<p>The above growth model assumes that we know the age at recovery <span class="math inline">\(a_{2,i}\)</span>. The problem we have is, we have 22 569 tag recoveries with length information but only a handful of these have been aged. This is dealt with by modelling <span class="math inline">\(a_{1,i}\)</span> as a random effect i.e., <span class="math inline">\(a_{1,i} \sim LN \left(\mu, \sigma^2\right)\)</span>.</p>
<p>What confuses is me here is how to assign a hyper distribution like the one above for the random effect variables <span class="math inline">\(a_{1,i}\)</span>. <span class="math inline">\(a_{1,i}\)</span> is expected to vary quite a bit because tagged fish at release have a broad length frequency and thus is expected to have a broad age at release? (ask someone about this because I may be misunderstanding something).</p>
</div>
</div>
<div id="simulation-test-the-lep-method" class="section level2 unnumbered hasAnchor">
<h2>Simulation test the “LEP” method<a href="growth.html#simulation-test-the-lep-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="growth.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## going to use parameters from Aires-da-Silva et al. (2015) Table 1 integrated analysis</span></span>
<span id="cb3-2"><a href="growth.html#cb3-2" aria-hidden="true" tabindex="-1"></a>L_inf <span class="ot">=</span> <span class="fl">200.8</span></span>
<span id="cb3-3"><a href="growth.html#cb3-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fl">0.44</span></span>
<span id="cb3-4"><a href="growth.html#cb3-4" aria-hidden="true" tabindex="-1"></a>t_0 <span class="ot">=</span> <span class="fl">1.26</span></span>
<span id="cb3-5"><a href="growth.html#cb3-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="sc">-</span><span class="fl">4.27</span></span>
<span id="cb3-6"><a href="growth.html#cb3-6" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">=</span> <span class="fl">0.15</span> <span class="do">## cv of length around length at age</span></span>
<span id="cb3-7"><a href="growth.html#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="growth.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">## selectivity paraemters</span></span>
<span id="cb3-9"><a href="growth.html#cb3-9" aria-hidden="true" tabindex="-1"></a>sel_a50 <span class="ot">=</span> <span class="fl">1.3</span></span>
<span id="cb3-10"><a href="growth.html#cb3-10" aria-hidden="true" tabindex="-1"></a>sel_ato95 <span class="ot">=</span> <span class="fl">0.8</span></span>
<span id="cb3-11"><a href="growth.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## sample sizes for simulation</span></span>
<span id="cb3-12"><a href="growth.html#cb3-12" aria-hidden="true" tabindex="-1"></a>n_sample_release <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb3-13"><a href="growth.html#cb3-13" aria-hidden="true" tabindex="-1"></a>n_sample_recoveries <span class="ot">=</span> <span class="dv">1000</span> <span class="sc">*</span> <span class="fl">0.1</span> <span class="do">## about the recovery rate from sablefish data</span></span>
<span id="cb3-14"><a href="growth.html#cb3-14" aria-hidden="true" tabindex="-1"></a>n_sample_age_length <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb3-15"><a href="growth.html#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="growth.html#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="do">## generate a pseudo age structure</span></span>
<span id="cb3-17"><a href="growth.html#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-18"><a href="growth.html#cb3-18" aria-hidden="true" tabindex="-1"></a>R_0 <span class="ot">=</span> <span class="dv">200000</span></span>
<span id="cb3-19"><a href="growth.html#cb3-19" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fl">0.29</span></span>
<span id="cb3-20"><a href="growth.html#cb3-20" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb3-21"><a href="growth.html#cb3-21" aria-hidden="true" tabindex="-1"></a>n_ages <span class="ot">=</span> <span class="fu">length</span>(ages)</span>
<span id="cb3-22"><a href="growth.html#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ages, mean_length_at_age, type = &quot;l&quot;, lwd = 3, xlab = &quot;Age&quot;, ylab = &quot;Length (cm)&quot;)</span></span>
<span id="cb3-23"><a href="growth.html#cb3-23" aria-hidden="true" tabindex="-1"></a>sel_at_age <span class="ot">=</span> <span class="fu">logis</span>(ages, sel_a50, sel_ato95)</span>
<span id="cb3-24"><a href="growth.html#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="growth.html#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="do">## numbers at age</span></span>
<span id="cb3-26"><a href="growth.html#cb3-26" aria-hidden="true" tabindex="-1"></a>N_age <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">length =</span> n_ages, <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb3-27"><a href="growth.html#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (age_ndx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_ages) </span>
<span id="cb3-28"><a href="growth.html#cb3-28" aria-hidden="true" tabindex="-1"></a>  N_age[age_ndx] <span class="ot">=</span> R_0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>ages[age_ndx] <span class="sc">*</span> M) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.7</span>))</span>
<span id="cb3-29"><a href="growth.html#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="growth.html#cb3-30" aria-hidden="true" tabindex="-1"></a>N_age <span class="ot">=</span> N_age <span class="sc">*</span> sel_at_age <span class="do">## vulnerable numbers at age</span></span>
<span id="cb3-31"><a href="growth.html#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="growth.html#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages, N_age, <span class="at">ylab =</span> <span class="st">&quot;Numbers&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Population age-structure&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/simulate_data-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="growth.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## plot growth</span></span>
<span id="cb4-2"><a href="growth.html#cb4-2" aria-hidden="true" tabindex="-1"></a>mean_length_at_age <span class="ot">=</span> <span class="fu">richards_growth</span>(ages, p, k, t_0, L_inf)</span>
<span id="cb4-3"><a href="growth.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## randomly sample 1000 individuals with replacement for otolithing no ageing error!!</span></span>
<span id="cb4-4"><a href="growth.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-5"><a href="growth.html#cb4-5" aria-hidden="true" tabindex="-1"></a>individual_age_length_df <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb4-6"><a href="growth.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sample_age_length) {</span>
<span id="cb4-7"><a href="growth.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  age_i <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_ages, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> N_age)</span>
<span id="cb4-8"><a href="growth.html#cb4-8" aria-hidden="true" tabindex="-1"></a>  mean_length_i <span class="ot">=</span> <span class="fu">richards_growth</span>(age_i, p, k, t_0, L_inf)</span>
<span id="cb4-9"><a href="growth.html#cb4-9" aria-hidden="true" tabindex="-1"></a>  length_i <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mean_length_i, mean_length_i <span class="sc">*</span> cv)</span>
<span id="cb4-10"><a href="growth.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  temp_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">age =</span> age_i, <span class="at">length =</span> length_i)</span>
<span id="cb4-11"><a href="growth.html#cb4-11" aria-hidden="true" tabindex="-1"></a>  individual_age_length_df <span class="ot">=</span> <span class="fu">rbind</span>(individual_age_length_df, temp_df)</span>
<span id="cb4-12"><a href="growth.html#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="growth.html#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="growth.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate a tag-recapture experiment </span></span>
<span id="cb4-15"><a href="growth.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># releases</span></span>
<span id="cb4-16"><a href="growth.html#cb4-16" aria-hidden="true" tabindex="-1"></a>release_ages <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_ages, <span class="at">size =</span> n_sample_release, <span class="at">prob =</span> N_age, <span class="at">replace =</span> T)</span>
<span id="cb4-17"><a href="growth.html#cb4-17" aria-hidden="true" tabindex="-1"></a>release_mean_lengths <span class="ot">=</span> <span class="fu">richards_growth</span>(release_ages, p, k, t_0, L_inf)</span>
<span id="cb4-18"><a href="growth.html#cb4-18" aria-hidden="true" tabindex="-1"></a>release_lengths <span class="ot">=</span> <span class="fu">rnorm</span>(n_sample_release, release_mean_lengths, release_mean_lengths <span class="sc">*</span> cv)</span>
<span id="cb4-19"><a href="growth.html#cb4-19" aria-hidden="true" tabindex="-1"></a>individual_release_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">release_age =</span> release_ages, <span class="at">release_length =</span> release_lengths, <span class="at">release_mean_length =</span> release_mean_lengths)</span>
<span id="cb4-20"><a href="growth.html#cb4-20" aria-hidden="true" tabindex="-1"></a>individual_release_df<span class="sc">$</span>fish_id <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(individual_release_df)</span>
<span id="cb4-21"><a href="growth.html#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="growth.html#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># recaptures sample uniformly without replacement</span></span>
<span id="cb4-23"><a href="growth.html#cb4-23" aria-hidden="true" tabindex="-1"></a>fish_ndx <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(individual_release_df), <span class="at">size =</span> n_sample_recoveries, <span class="at">replace =</span> F) </span>
<span id="cb4-24"><a href="growth.html#cb4-24" aria-hidden="true" tabindex="-1"></a>individual_recovery_df <span class="ot">=</span> <span class="fu">subset</span>(individual_release_df, <span class="at">subset =</span> individual_release_df<span class="sc">$</span>fish_id <span class="sc">%in%</span> fish_ndx)</span>
<span id="cb4-25"><a href="growth.html#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="do">## time-at liberty days randomly recovered on average between 100-600 days</span></span>
<span id="cb4-26"><a href="growth.html#cb4-26" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>time_at_liberty <span class="ot">=</span> <span class="fu">rpois</span>(<span class="at">n =</span> n_sample_recoveries, <span class="at">lambda =</span> <span class="fu">runif</span>(n_sample_recoveries,<span class="dv">100</span>,<span class="dv">600</span>))</span>
<span id="cb4-27"><a href="growth.html#cb4-27" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>recovery_age <span class="ot">=</span> individual_recovery_df<span class="sc">$</span>release_age <span class="sc">+</span> individual_recovery_df<span class="sc">$</span>time_at_liberty<span class="sc">/</span><span class="dv">365</span></span>
<span id="cb4-28"><a href="growth.html#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="do">## how to add the length increment between release and recovery?</span></span>
<span id="cb4-29"><a href="growth.html#cb4-29" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>recovery_mean_length <span class="ot">=</span> <span class="fu">richards_growth</span>(individual_recovery_df<span class="sc">$</span>recovery_age, p, k, t_0, L_inf)</span>
<span id="cb4-30"><a href="growth.html#cb4-30" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>recovery_mean_length_increment <span class="ot">=</span> <span class="fu">with</span>(individual_recovery_df, recovery_mean_length <span class="sc">-</span> release_mean_length)</span>
<span id="cb4-31"><a href="growth.html#cb4-31" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>recovery_length <span class="ot">=</span> <span class="fu">with</span>(individual_recovery_df, release_length <span class="sc">+</span> <span class="fu">rlnorm</span>(n_sample_recoveries, <span class="fu">log</span>(recovery_mean_length_increment), cv))</span>
<span id="cb4-32"><a href="growth.html#cb4-32" aria-hidden="true" tabindex="-1"></a>individual_recovery_df<span class="sc">$</span>growth_change <span class="ot">=</span> individual_recovery_df<span class="sc">$</span>recovery_length <span class="sc">-</span> individual_recovery_df<span class="sc">$</span>release_length </span>
<span id="cb4-33"><a href="growth.html#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="growth.html#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="do">## visualise length at age samples</span></span>
<span id="cb4-35"><a href="growth.html#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(individual_age_length_df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> length)) <span class="sc">+</span></span>
<span id="cb4-36"><a href="growth.html#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-37"><a href="growth.html#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span> <span class="fu">data.frame</span>(<span class="at">length =</span> mean_length_at_age, <span class="at">age =</span> ages), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> length), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">inherit.aes =</span> F) <span class="sc">+</span></span>
<span id="cb4-38"><a href="growth.html#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Length&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-39"><a href="growth.html#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="cn">NA</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/simulate_data-2.png" width="672" /></p>
<p>Assumptions in the above OM follow.</p>
<p><span class="math display">\[
l_{1,i} \sim \mathcal{N} \left(\bar{l}_{1,a}, \sigma = \bar{l}_{1,a} \times cv\right)
\]</span>
where the mean length at age release (<span class="math inline">\(\bar{l}_{1,a}\)</span>) follows the Richards growth curve defined in Equation <a href="growth.html#eq:richardsgrowth">(8.1)</a>. The age used to derive the mean length at age was a random sample with replacement from the population in shown in the earlier figure. Time at liberty was drawn from a Poisson distribution with a rate parameter randomly drawn from a uniform distribution between 100-600 days. The age at recovery <span class="math inline">\(a_{2,i} = a_{1,i} + \Delta_t\)</span>. An approximation was made when calculating the length at recovery. The length increment (<span class="math inline">\(l_{\Delta_t}\)</span>) was simulated using a Log Normal distribution with the median set based on the difference between mean length at release age and mean length at recovery age. This was to ensure all recovered fish positively grew at a rate expected by the growth model (less than ideal but will do for now).
<span class="math display">\[
l_{i,\Delta_t} \sim \mathcal{LN} \left(\ln (\bar{l}_{a_{2,i}} - \bar{l}_{a_{1,i}}), \sigma = cv\right)
\]</span></p>
<p><span class="math display">\[
l_{2,i} = l_{1,i} + l_{i, \Delta_t}
\]</span>
In theory we can now pass this data to our LEP model to back estimate growth parameters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="growth.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="fu">file.path</span>(<span class="st">&quot;TMB&quot;</span>))</span>
<span id="cb5-2"><a href="growth.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sink(file = &quot;compile_output.txt&quot;)</span></span>
<span id="cb5-3"><a href="growth.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">compile</span>(<span class="at">file =</span> <span class="st">&quot;LEPgrowth_model.cpp&quot;</span>, <span class="at">flags =</span> <span class="st">&quot;-Wignored-attributes -O3&quot;</span>)</span>
<span id="cb5-4"><a href="growth.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sink()</span></span>
<span id="cb5-5"><a href="growth.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dyn.load</span>(<span class="fu">dynlib</span>(<span class="st">&quot;LEPgrowth_model&quot;</span>))</span>
<span id="cb5-6"><a href="growth.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd(DIR$book)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="growth.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb6-2"><a href="growth.html#cb6-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb6-3"><a href="growth.html#cb6-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ages_from_age_length <span class="ot">=</span> individual_age_length_df<span class="sc">$</span>age</span>
<span id="cb6-4"><a href="growth.html#cb6-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>lengths_from_age_length <span class="ot">=</span> individual_age_length_df<span class="sc">$</span>length</span>
<span id="cb6-5"><a href="growth.html#cb6-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>lengths_at_release <span class="ot">=</span> individual_recovery_df<span class="sc">$</span>release_length</span>
<span id="cb6-6"><a href="growth.html#cb6-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>lengths_at_recovery <span class="ot">=</span> individual_recovery_df<span class="sc">$</span>recovery_length</span>
<span id="cb6-7"><a href="growth.html#cb6-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>time_at_liberty <span class="ot">=</span> individual_recovery_df<span class="sc">$</span>time_at_liberty <span class="sc">/</span> <span class="dv">365</span></span>
<span id="cb6-8"><a href="growth.html#cb6-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>ages_for_report <span class="ot">=</span> ages;</span>
<span id="cb6-9"><a href="growth.html#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="growth.html#cb6-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>p_bounds <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb6-11"><a href="growth.html#cb6-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>t0_bounds <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb6-12"><a href="growth.html#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="growth.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb6-14"><a href="growth.html#cb6-14" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb6-15"><a href="growth.html#cb6-15" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_cv_length_at_age <span class="ot">=</span> <span class="fu">log</span>(cv)</span>
<span id="cb6-16"><a href="growth.html#cb6-16" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_k <span class="ot">=</span> <span class="fu">log</span>(k)</span>
<span id="cb6-17"><a href="growth.html#cb6-17" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_L_inf <span class="ot">=</span> <span class="fu">log</span>(L_inf)</span>
<span id="cb6-18"><a href="growth.html#cb6-18" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>logit_p <span class="ot">=</span>  <span class="fu">logit_general</span>(p, data<span class="sc">$</span>p_bounds[<span class="dv">1</span>],data<span class="sc">$</span>p_bounds[<span class="dv">2</span>])</span>
<span id="cb6-19"><a href="growth.html#cb6-19" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>logit_t0 <span class="ot">=</span>  <span class="fu">logit_general</span>(t_0, data<span class="sc">$</span>t0_bounds[<span class="dv">1</span>],data<span class="sc">$</span>t0_bounds[<span class="dv">2</span>])</span>
<span id="cb6-20"><a href="growth.html#cb6-20" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_cv_length_release <span class="ot">=</span> <span class="fu">log</span>(<span class="fl">0.1</span>)</span>
<span id="cb6-21"><a href="growth.html#cb6-21" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_cv_length_recovery <span class="ot">=</span> <span class="fu">log</span>(<span class="fl">0.1</span>)</span>
<span id="cb6-22"><a href="growth.html#cb6-22" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_age_at_release <span class="ot">=</span> <span class="fu">log</span>(individual_recovery_df<span class="sc">$</span>release_age)</span>
<span id="cb6-23"><a href="growth.html#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="growth.html#cb6-24" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_mu_age_release <span class="ot">=</span> <span class="fu">log</span>(<span class="dv">3</span>)</span>
<span id="cb6-25"><a href="growth.html#cb6-25" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">$</span>ln_sd_age_release <span class="ot">=</span> <span class="fu">log</span>(<span class="dv">1</span>)</span>
<span id="cb6-26"><a href="growth.html#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="growth.html#cb6-27" aria-hidden="true" tabindex="-1"></a>obj_mixed_all <span class="ot">&lt;-</span> <span class="fu">MakeADFun</span>(data, parameters, <span class="at">random =</span> <span class="st">&quot;ln_age_at_release&quot;</span>, <span class="at">DLL=</span><span class="st">&quot;LEPgrowth_model&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="growth.html#cb7-1" aria-hidden="true" tabindex="-1"></a>MLE_mixed_all <span class="ot">=</span> <span class="fu">nlminb</span>(<span class="at">start =</span> obj_mixed_all<span class="sc">$</span>par, <span class="at">objective =</span> obj_mixed_all<span class="sc">$</span>fn, <span class="at">gradient  =</span> obj_mixed_all<span class="sc">$</span>gr)</span>
<span id="cb7-2"><a href="growth.html#cb7-2" aria-hidden="true" tabindex="-1"></a>MLE_mixed_all<span class="sc">$</span>convergence</span>
<span id="cb7-3"><a href="growth.html#cb7-3" aria-hidden="true" tabindex="-1"></a>MLE_mixed_all_rep <span class="ot">=</span> obj_mixed_all<span class="sc">$</span><span class="fu">report</span>(obj_mixed_all<span class="sc">$</span>env<span class="sc">$</span>last.par.best)</span>
<span id="cb7-4"><a href="growth.html#cb7-4" aria-hidden="true" tabindex="-1"></a>MLE_mixed_all_sd_rep <span class="ot">=</span> <span class="fu">sdreport</span>(obj_mixed_all)</span>
<span id="cb7-5"><a href="growth.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages, MLE_mixed_all_rep<span class="sc">$</span>mean_length_at_age, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Length (cm)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">240</span>))</span>
<span id="cb7-6"><a href="growth.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ages, mean_length_at_age, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb7-7"><a href="growth.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;LEP obs error&quot;</span>,<span class="st">&quot;True&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/optimise_TMB_model-1.png" width="672" /></p>
</div>
<div id="next-steps" class="section level2 unnumbered hasAnchor">
<h2>Next steps<a href="growth.html#next-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Check sensitivity to the model to starting parameters</li>
<li>Repeat with different sample sizes</li>
<li>Repeat with a truncated age-structure for the age-length data using a selectivity</li>
<li>Look at Sablefish data and see if the LEP approach can be used to it</li>
<li>Explore alternative growth models i.e., <span class="citation">Schnute (<a href="#ref-schnute1981versatile" role="doc-biblioref">1981</a>)</span></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aires2015improved" class="csl-entry">
Aires-da-Silva, Alexandre M, Mark N Maunder, Kurt M Schaefer, and Daniel W Fuller. 2015. <span>“Improved Growth Estimates from Integrated Analysis of Direct Aging and Tag–Recapture Data: An Illustration with Bigeye Tuna (<em>Thunnus Obesus</em>) of the Eastern Pacific Ocean with Implications for Management.”</span> <em>Fisheries Research</em> 163: 119–26.
</div>
<div id="ref-eveson2004integrated" class="csl-entry">
Eveson, J Paige, Geoff M Laslett, and Tom Polacheck. 2004. <span>“An Integrated Model for Growth Incorporating Tag Recapture, Length Frequency, and Direct Aging Data.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 61 (2): 292–306.
</div>
<div id="ref-laslett2002flexible" class="csl-entry">
Laslett, Geoff M, J Paige Eveson, and Tom Polacheck. 2002. <span>“A Flexible Maximum Likelihood Approach for Fitting Growth Curves to Tag Recapture Data.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 59 (6): 976–86.
</div>
<div id="ref-schnute1981versatile" class="csl-entry">
Schnute, Jon. 1981. <span>“A Versatile Growth Model with Statistically Stable Parameters.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 38 (9): 1128–40.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tagdata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="refpoints.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://www.fisheries.noaa.gov/alaska/science-data/alaska-sablefish-fisheries-and-assessment/07-Growth.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"depth": 1
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
